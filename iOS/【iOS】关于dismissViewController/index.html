<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css"><script src="/lib/pace/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"fengyanxin.github.io",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:"mac"},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!0,pangu:!0,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!0,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="前言工程中有个多层控制器时，调用 dismissViewControllerAnimated 时不时会不起作用。 原理我们都知道 dismissViewControllerAnimated:completion: 方法是针对被 present 出来的控制器的。 一般我们这样使用：在一个控制器中 present 另外一个控制器A，然后在A中执行 dismissViewControllerAnimat"><meta property="og:type" content="article"><meta property="og:title" content="【iOS】关于 dismissViewController"><meta property="og:url" content="https://fengyanxin.github.io/iOS/%E3%80%90iOS%E3%80%91%E5%85%B3%E4%BA%8EdismissViewController/index.html"><meta property="og:site_name" content="凤炎忻的个人笔记"><meta property="og:description" content="前言工程中有个多层控制器时，调用 dismissViewControllerAnimated 时不时会不起作用。 原理我们都知道 dismissViewControllerAnimated:completion: 方法是针对被 present 出来的控制器的。 一般我们这样使用：在一个控制器中 present 另外一个控制器A，然后在A中执行 dismissViewControllerAnimat"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://raw.githubusercontent.com/fengyanxin/YXBlogPic/main/17449556028643.jpg"><meta property="article:published_time" content="2025-04-18T05:38:22.000Z"><meta property="article:modified_time" content="2025-05-15T01:22:07.397Z"><meta property="article:author" content="凤炎忻"><meta property="article:tag" content="iOS"><meta property="article:tag" content="OC"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://raw.githubusercontent.com/fengyanxin/YXBlogPic/main/17449556028643.jpg"><link rel="canonical" href="https://fengyanxin.github.io/iOS/%E3%80%90iOS%E3%80%91%E5%85%B3%E4%BA%8EdismissViewController/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/ilyabirman-likely@2/release/likely.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.css"><style>#needsharebutton-postbottom{cursor:pointer;height:26px;margin-top:10px;position:relative}#needsharebutton-postbottom .btn{border:1px solid $btn-default-border-color;border-radius:3px;display:initial;padding:1px 4px}</style><title>【iOS】关于 dismissViewController | 凤炎忻的个人笔记</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="凤炎忻的个人笔记" type="application/atom+xml"><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">凤炎忻的个人笔记</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">我有一壶酒，足以慰风尘！</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"> <a href="/" rel="section">首页</a></li><li class="menu-item menu-item-tags"> <a href="/tags/" rel="section">标签<span class="badge">9</span></a></li><li class="menu-item menu-item-categories"> <a href="/categories/" rel="section">分类<span class="badge">7</span></a></li><li class="menu-item menu-item-archives"> <a href="/archives/" rel="section">归档<span class="badge">37</span></a></li><li class="menu-item menu-item-commonweal"> <a href="/404/" rel="section">公益 404</a></li><li class="menu-item menu-item-search"> <a role="button" class="popup-trigger">搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://fengyanxin.github.io/iOS/%E3%80%90iOS%E3%80%91%E5%85%B3%E4%BA%8EdismissViewController/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/flyingPig.jpeg"><meta itemprop="name" content="凤炎忻"><meta itemprop="description" content="性浮脱，难酬一道，广涉寡精，杂而不博"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="凤炎忻的个人笔记"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> 【iOS】关于 dismissViewController</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2025-04-18 13:38:22" itemprop="dateCreated datePublished" datetime="2025-04-18T13:38:22+08:00">2025-04-18</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-05-15 09:22:07" itemprop="dateModified" datetime="2025-05-15T09:22:07+08:00">2025-05-15</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a></span></span><span id="/iOS/%E3%80%90iOS%E3%80%91%E5%85%B3%E4%BA%8EdismissViewController/" class="post-meta-item leancloud_visitors" data-flag-title="【iOS】关于 dismissViewController" title="阅读次数"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span class="leancloud-visitors-count"></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Valine：</span><a title="valine" href="/iOS/%E3%80%90iOS%E3%80%91%E5%85%B3%E4%BA%8EdismissViewController/#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/iOS/%E3%80%90iOS%E3%80%91%E5%85%B3%E4%BA%8EdismissViewController/" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>1.2k</span></span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span>4 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>工程中有个多层控制器时，调用 <code>dismissViewControllerAnimated</code> 时不时会不起作用。</p><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>我们都知道 <code>dismissViewControllerAnimated:completion:</code> 方法是针对被 <code>present</code> 出来的控制器的。</p><p>一般我们这样使用：在一个控制器中 <code>present</code> 另外一个控制器A，然后在A中执行 <code>dismissViewControllerAnimated:completion:</code> 让自己消失。</p><span id="more"></span><p>在 <code>ViewController</code>中：</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">AViewController</span> <span class="operator">*</span>av <span class="operator">=</span> [[<span class="type">AViewController</span> alloc] <span class="keyword">init</span>];</span><br><span class="line"><span class="type">UINavigationController</span> <span class="operator">*</span>nav <span class="operator">=</span> [[<span class="type">UINavigationController</span> alloc] initWithRootViewController:av];</span><br><span class="line">[<span class="keyword">self</span> presentViewController:nav animated:<span class="type">YES</span> completion:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure><p>在 <code>AViewController</code> 中执行 <code>disimiss</code>：</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">self</span> dismissViewControllerAnimated:<span class="type">YES</span> completion:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure><p>对于上面这种常见的场景，这种用法完全没问题。</p><p>但是对于复杂一点的场景，这种用法就有点苍白无力了，先举个稍微复杂一点点的例子：</p><p><code>ViewController present AViewController</code>，<code>AViewController present BViewController</code>，在 <code>BViewController</code> 执行完某事件之后需要返回 <code>ViewControlle</code>。这个时候需要怎样做呢？如果在 <code>BViewController</code> 直接执行 <code>[self dismissViewControllerAnimated:YES completion:nil];</code> 的话，它只会将 <code>BViewController</code> 消失。</p><p>这里你可能会想到通过其他方式拿到 <code>AViewController</code>，然后调用 <code>AViewController的[self dismissViewControllerAnimated:YES completion:nil];</code>。但是，场景再复杂一点，在执行完各种 <code>present</code> 和 <code>push</code> 之后，到达了 <code>XViewController</code>，在 <code>XViewController</code> 中执行成功任务之后需要回到 <code>ViewController</code>，这个时候怎么办呢？我们知道当前如果有被 <code>present</code> 出来的控制器的情况下，调用 <code>UINavigationController</code> 的 <code>popToRootViewControllerAnimated:</code> 是不起作用的。</p><p>那么我们如何把这个流程中所有被 <code>present</code> 和 <code>push</code> 的控制器给销毁呢？笨一点的办法是回溯整个流程，判断哪些控制器需要 <code>dismiss</code>，哪些控制器需要 <code>pop</code>。但这种方式显然有点低效和难以控制，下面我们来看看到底该怎么使用 <code>dismissViewControllerAnimated:completion:</code>。</p><p>我们先看看官方文档到底怎么讲的：</p><blockquote><p>Dismisses the view controller that was presented modally by the view controller.</p><p>The presenting view controller is responsible for dismissing the view controller it presented. If you call this method on the presented view controller itself, UIKit asks the presenting view controller to handle the dismissal.</p><p>If you present several view controllers in succession, thus building a stack of presented view controllers, calling this method on a view controller lower in the stack dismisses its immediate child view controller and all view controllers above that child on the stack. When this happens, only the top-most view is dismissed in an animated fashion; any intermediate view controllers are simply removed from the stack. The top-most view is dismissed using its modal transition style, which may differ from the styles used by other view controllers lower in the stack.</p></blockquote><p>可以简单归纳为两点：</p><ol><li>谁 <code>present</code> 出来的控制器，谁负责把它 <code>dismiss</code> 掉，但是如果你在被 <code>present</code> 出来的控制器中调用 <code>dismiss</code> 的话，UIKit会自动让它的 <code>presenting</code> 控制器（找到谁把它present出来的）去执行 <code>dismiss</code>。</li><li>如果你 <code>present</code> 了一系列的控制器，那么系统会把被 <code>present</code> 出来的控制器放在一个栈中，当处在底层的控制器执行 <code>dismiss</code> 的时候，在它之后被 <code>present</code> 出来的控制器都会被移除，只有栈顶上的控制器会有 <code>dismiss</code> 动画。</li></ol><p>另外补充相关的两点：</p><ol><li><p>当被 <code>present</code> 出来的控制器的 <code>modalPresentationStyle = UIModalPresentationFullScreen</code> 时，执行当前 <code>present</code> 事件的控制器必须是一个全屏控制器，如果当前执行的控制器不是一个全屏的控制器，它将在视图层级结构中找到一个全屏的父类控制器去执行 <code>present</code> 事件。也就是说如果 <code>A</code> 执行 <code>present B</code>，那么 <code>B.presentingViewController</code> 不一定是 <code>A</code>。比如你当前的控制器 <code>A</code> 在导航 <code>nav</code> 中，<code>A present B</code> 之后，实际上 <code>B.presentingViewController</code> 指向的是 <code>nav</code> 而不是 <code>A</code>。</p></li><li><p><code>self.presentingViewController</code>，它指向的是把当前控制器 <code>present</code> 出来的控制器或者是把当前控制器的最上层的父类 <code>present</code> 出来的控制器。</p></li></ol><p>通过上面的文档介绍，我们可以看到在本文刚开始介绍的最简单的使用场景下 <code>（ViewController present AViewController）</code>，在 <code>AViewController</code> 中执行 <code>[self dismissViewControllerAnimated:YES completion:nil]</code> 和在 <code>ViewController</code> 中执行 <code>[self dismissViewControllerAnimated:YES completion:nil]</code> 效果是一样的，这一点是因为系统帮我们处理好了（因为系统判判 <code>AViewController</code> 当前没有 <code>present</code> 出来任何控制器，所以系统会找到它的 <code>presentingViewController</code>，也就是 <code>ViewController</code> 来执行 <code>dismiss</code> 事件）。</p><p>在复杂一点的情况下，比如我们要 <code>dismiss</code> 掉当前被 <code>present</code> 出来的控制器的话，我们就需要想办法拿到处在栈底的那个控制器，在这个控制器中执行 <code>[self dismissViewControllerAnimated:YES completion:nil]</code> 才行。</p><p>那么很显然，执行 <code>[self dismissViewControllerAnimated:YES completion:nil]</code> 的流程是这样子的：</p><p><img data-src="https://raw.githubusercontent.com/fengyanxin/YXBlogPic/main/17449556028643.jpg"></p><p>在我们上面讲的复杂场景下，我们怎么一次性把当前 <code>present</code> 出来的控制都 <code>dismiss</code> 掉呢？可以通过下面的方式来查找到最顶层的 <code>presentingViewController</code>（其实，通常是我们 <code>window</code> 的 <code>rootViewController</code>）让它来执行 <code>dismiss</code> 就好了，剩下的工作可能就是处理一下导航中的控制器了。</p><p>比如我们在经过各种 <code>present</code> 和 <code>push</code> 之后才到达的 <code>XViewController</code> 页面中执行如下代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">UIViewController *presentingVc = self.presentingViewController;</span><br><span class="line">while (presentingVc.presentingViewController) &#123;</span><br><span class="line">    presentingVc = vc.presentingViewController;</span><br><span class="line">&#125;</span><br><span class="line">if(presentingVc)&#123;</span><br><span class="line">    [presentingVc dismissViewControllerAnimated:YES completion:nil];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/ea5af4057d64">https://www.jianshu.com/p/ea5af4057d64</a></p></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------<i class="fa fa-paw"></i> That's all！Best wishes for you !!!<i class="fa fa-paw"></i> -------------</div></div></div><div class="post-widgets"><div class="likely"><div class="twitter">Tweet</div><div class="facebook">Share</div><div class="linkedin">Link</div><div class="gplus">Plus</div><div class="vkontakte">Share</div><div class="odnoklassniki">Class</div><div class="telegram">Send</div><div class="whatsapp">Send</div><div class="pinterest">Pin</div></div></div><script src="//cdn.jsdelivr.net/npm/ilyabirman-likely@2/release/likely.min.js"></script><div class="post-widgets"><div id="needsharebutton-postbottom"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 凤炎忻</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://fengyanxin.github.io/iOS/%E3%80%90iOS%E3%80%91%E5%85%B3%E4%BA%8EdismissViewController/" title="【iOS】关于 dismissViewController">https://fengyanxin.github.io/iOS/【iOS】关于dismissViewController/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="followme"><p>欢迎关注我的其它发布渠道</p><div class="social-list"><div class="social-item"><a target="_blank" class="social-link" href="https://github.com/fengyanxin"><span class="icon"><i class="fab fa-github"></i></span> <span class="label">GitHub</span></a></div><div class="social-item"><a target="_blank" class="social-link" href="https://www.zhihu.com/people/peng-he-34-93"><span class="icon"><i class="fab fa-zhihu"></i></span> <span class="label">知乎</span></a></div><div class="social-item"><a target="_blank" class="social-link" href="https://profile.zjurl.cn/rogue/ugc/profile/?user_id=51893718065"><span class="icon"><i class="fa fa-toutiao"></i></span> <span class="label">今日头条</span></a></div><div class="social-item"><a target="_blank" class="social-link" href="https://author.baidu.com/home?from=bjh_article&app_id=1665765419554477"><span class="icon"><i class="fa fa-baidu1"></i></span> <span class="label">百家号</span></a></div><div class="social-item"><a target="_blank" class="social-link" href="https://www.xiaohongshu.com/user/profile/642cb9650000000011023394"><span class="icon"><i class="fab fa-xiaohongshu1"></i></span> <span class="label">小红书</span></a></div><div class="social-item"><a target="_blank" class="social-link" href="https://www.liblib.art/userpage/c7816525373d4fbca7e45c1940ead98e"><span class="icon"><i class="fab fa-liblib1"></i></span> <span class="label">LibLib</span></a></div><div class="social-item"><a target="_blank" class="social-link" href="/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/iOS/" rel="tag"><i class="fa fa-tag"></i> iOS</a><a href="/tags/OC/" rel="tag"><i class="fa fa-tag"></i> OC</a></div><div class="post-nav"><div class="post-nav-item"><a href="/iOS/%E3%80%90iOS%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%BF%E9%97%AE%E7%A7%81%E6%9C%89%E5%BA%93%E4%B8%AD%E7%9A%84%E5%9B%BE%E7%89%87%E3%80%81Xib%E8%B5%84%E6%BA%90/" rel="prev" title="【iOS】如何访问私有库中的图片、Xib资源"><i class="fa fa-chevron-left"></i> 【iOS】如何访问私有库中的图片、Xib资源</a></div><div class="post-nav-item"> <a href="/iOS/%E3%80%90iOS%E3%80%91-Runtime%E8%AF%A6%E8%A7%A3/" rel="next" title="【iOS】 Runtime 详解">【iOS】 Runtime 详解<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%9F%E7%90%86"><span class="nav-number">2.</span> <span class="nav-text">原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">3.</span> <span class="nav-text">参考</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="凤炎忻" src="/images/flyingPig.jpeg"><p class="site-author-name" itemprop="name">凤炎忻</p><div class="site-description" itemprop="description">性浮脱，难酬一道，广涉寡精，杂而不博</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">37</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">7</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">9</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/fengyanxin" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;fengyanxin" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:ph18317192001@163.com" title="E-Mail → mailto:ph18317192001@163.com" rel="noopener" target="_blank"><i class="fab fa-mail fa-fw"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://profile.zjurl.cn/rogue/ugc/profile/?user_id=51893718065" title="今日头条 → https:&#x2F;&#x2F;profile.zjurl.cn&#x2F;rogue&#x2F;ugc&#x2F;profile&#x2F;?user_id&#x3D;51893718065" rel="noopener" target="_blank"><i class="fab fa-jinritoutiao fa-fw"></i> 今日头条</a></span><span class="links-of-author-item"><a href="https://author.baidu.com/home?from=bjh_article&app_id=1665765419554477" title="百家号 → https:&#x2F;&#x2F;author.baidu.com&#x2F;home?from&#x3D;bjh_article&amp;app_id&#x3D;1665765419554477" rel="noopener" target="_blank"><i class="fab fa-baidu fa-fw"></i> 百家号</a></span><span class="links-of-author-item"><a href="https://www.xiaohongshu.com/user/profile/642cb9650000000011023394" title="小红书 → https:&#x2F;&#x2F;www.xiaohongshu.com&#x2F;user&#x2F;profile&#x2F;642cb9650000000011023394" rel="noopener" target="_blank"><i class="fab fa-xiaohongshu fa-fw"></i> 小红书</a></span><span class="links-of-author-item"><a href="https://www.liblib.art/userpage/c7816525373d4fbca7e45c1940ead98e" title="LibLib → https:&#x2F;&#x2F;www.liblib.art&#x2F;userpage&#x2F;c7816525373d4fbca7e45c1940ead98e" rel="noopener" target="_blank"><i class="fab fa-liblib fa-fw"></i> LibLib</a></span></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2020 – <span itemprop="copyrightYear">2025</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">凤炎忻</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-chart-area"></i></span> <span class="post-meta-item-text">站点总字数：</span> <span title="站点总字数">78k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span class="post-meta-item-text">站点阅读时长 &asymp;</span> <span title="站点阅读时长">4:43</span></div><div class="addthis_inline_share_toolbox"><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-64097eaa671e32e2" async="async"></script></div></div></footer></div><script color="255,255,255" opacity="0.95" zindex="-1" count="150" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script><script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script><script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script><script>
var options = {
  bottom: '64px',
  right: 'unset',
  left: '32px',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: '🌓',
  autoMatchOsTheme: false
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script><script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.js"></script><script>pbOptions={iconStyle:"box",boxForm:"horizontal",position:"bottomCenter",networks:"Weibo,Wechat,Douban,QQZone,Twitter,Facebook"},new needShareButton("#needsharebutton-postbottom",pbOptions)</script><script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : true,
      appId      : '7EJkVswo79CmfmbwincRPjrA-gzGzoHsz',
      appKey     : 'v7t6DWozwkcL2qIDeSC5kupC',
      placeholder: "说点什么吧！",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script></body></html>